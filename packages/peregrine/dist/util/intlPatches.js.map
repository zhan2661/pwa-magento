{"version":3,"sources":["../../src/util/intlPatches.js"],"names":["intlFormats","USD","symbol","decimal","groupDelim","GBP","EUR","IntlPatches","formatToPartsPatch","num","currency","maximumFractionDigits","useGrouping","format","toFixed","match","integer","fraction","parts","type","value","intParts","firstGroupLength","length","push","JSON","stringify","slice","groups","map","intPart","groupDelimJSON","intAndGroupParts","parse","join","concat","toParts","formatToParts","resolvedOptions"],"mappings":"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","sourcesContent":["/**\n * A [ponyfill](https://github.com/sindresorhus/ponyfill) is an opt-in polyfill,\n * which replaces missing builtins on older or non-compliant platforms, but\n * without monkey-patching the native API.\n *\n * Many browsers do not yet support Intl.NumberFormat.prototype.formatToParts,\n * which is tracked here: https://github.com/tc39/proposal-intl-formatToParts\n *\n * The polyfill available in that repository covers many edge cases, but it's\n * more functionality than we need at this stage, it's not distributed over\n * NPM, and it's 18kb. The below\n * [ponyfill](https://github.com/sindresorhus/ponyfill) is not fully compliant,\n * but it'll do for now.\n *\n * TODO: Replace with a formally maintained, but small-enough, ponyfill.\n */\n\nconst intlFormats = {\n    USD: {\n        symbol: '$',\n        decimal: '.',\n        groupDelim: ','\n    },\n    GBP: {\n        symbol: '£',\n        decimal: '.',\n        groupDelim: ','\n    },\n    EUR: {\n        symbol: '€',\n        decimal: '.',\n        groupDelim: ','\n    }\n};\n\nconst IntlPatches = {\n    formatToPartsPatch({ currency, maximumFractionDigits, useGrouping }, num) {\n        const format = intlFormats[currency] || {\n            ...intlFormats.USD,\n            symbol: currency\n        };\n        const { symbol, decimal, groupDelim } = format;\n        let [integer, fraction] = num\n            .toFixed(maximumFractionDigits)\n            .match(/\\d+/g);\n        const parts = [{ type: 'currency', value: symbol }];\n        if (useGrouping !== false) {\n            const intParts = [];\n            const firstGroupLength = integer.length % 3;\n            if (firstGroupLength > 0) {\n                intParts.push(\n                    JSON.stringify({\n                        type: 'integer',\n                        value: integer.slice(0, firstGroupLength)\n                    })\n                );\n                integer = integer.slice(firstGroupLength);\n            }\n\n            const groups = integer.match(/\\d{3}/g);\n\n            if (groups) {\n                intParts.push(\n                    ...groups.map(intPart =>\n                        JSON.stringify({\n                            type: 'integer',\n                            value: intPart\n                        })\n                    )\n                );\n            }\n\n            const groupDelimJSON =\n                ',' +\n                JSON.stringify({\n                    type: 'group',\n                    value: groupDelim\n                }) +\n                ',';\n\n            const intAndGroupParts = JSON.parse(\n                `[${intParts.join(groupDelimJSON)}]`\n            );\n\n            parts.push(...intAndGroupParts);\n        } else {\n            parts.push({ type: 'integer', value: integer });\n        }\n        return parts.concat([\n            { type: 'decimal', value: decimal },\n            { type: 'fraction', value: fraction }\n        ]);\n    },\n\n    toParts(num) {\n        return this.formatToParts\n            ? this.formatToParts(num)\n            : IntlPatches.formatToPartsPatch(this.resolvedOptions(), num);\n    }\n};\nexport default IntlPatches;\n"],"file":"intlPatches.js"}