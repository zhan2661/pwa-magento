{"version":3,"sources":["../../src/reducers/checkout.js"],"names":["handleActions","get","Util","actions","BrowserPersistence","storage","name","initialState","availableShippingMethods","billingAddress","editing","paymentCode","paymentData","shippingAddress","shippingMethod","shippingTitle","step","submitting","isAddressIncorrect","incorrectAddressMessage","reducerMap","begin","state","storedBillingAddress","getItem","storedPaymentMethod","storedShippingAddress","storedShippingMethod","code","data","carrier_code","carrier_title","edit","payload","submit","accept","reject","getShippingMethods","receive","error","map","method","title","actionArgs","paymentMethod","order","reset"],"mappings":"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","sourcesContent":["import { handleActions } from 'redux-actions';\nimport get from 'lodash/get';\nimport { Util } from '@magento/peregrine';\nimport actions from 'src/actions/checkout';\n\nconst { BrowserPersistence } = Util;\nconst storage = new BrowserPersistence();\n\nexport const name = 'checkout';\n\nconst initialState = {\n    availableShippingMethods: [],\n    billingAddress: null,\n    editing: null,\n    paymentCode: '',\n    paymentData: null,\n    shippingAddress: null,\n    shippingMethod: '',\n    shippingTitle: '',\n    step: 'cart',\n    submitting: false,\n    isAddressIncorrect: false,\n    incorrectAddressMessage: ''\n};\n\nconst reducerMap = {\n    [actions.begin]: state => {\n        const storedBillingAddress = storage.getItem('billing_address');\n        const storedPaymentMethod = storage.getItem('paymentMethod');\n        const storedShippingAddress = storage.getItem('shipping_address');\n        const storedShippingMethod = storage.getItem('shippingMethod');\n\n        return {\n            ...state,\n            billingAddress: storedBillingAddress,\n            paymentCode: storedPaymentMethod && storedPaymentMethod.code,\n            paymentData: storedPaymentMethod && storedPaymentMethod.data,\n            shippingAddress: storedShippingAddress,\n            shippingMethod:\n                storedShippingMethod && storedShippingMethod.carrier_code,\n            shippingTitle:\n                storedShippingMethod && storedShippingMethod.carrier_title,\n            editing: null,\n            step: 'form'\n        };\n    },\n    [actions.edit]: (state, { payload }) => {\n        return {\n            ...state,\n            editing: payload,\n            incorrectAddressMessage: ''\n        };\n    },\n    [actions.billingAddress.submit]: state => state,\n    [actions.billingAddress.accept]: (state, { payload }) => {\n        return {\n            ...state,\n            billingAddress: payload\n        };\n    },\n    [actions.billingAddress.reject]: state => state,\n    [actions.getShippingMethods.receive]: (state, { payload, error }) => {\n        if (error) {\n            return state;\n        }\n\n        return {\n            ...state,\n            availableShippingMethods: payload.map(method => ({\n                ...method,\n                code: method.carrier_code,\n                title: method.carrier_title\n            }))\n        };\n    },\n    [actions.shippingAddress.submit]: state => {\n        return {\n            ...state,\n            submitting: true\n        };\n    },\n    [actions.shippingAddress.accept]: (state, { payload }) => {\n        return {\n            ...state,\n            editing: null,\n            shippingAddress: payload,\n            step: 'form',\n            submitting: false,\n            isAddressIncorrect: false,\n            incorrectAddressMessage: ''\n        };\n    },\n    [actions.shippingAddress.reject]: (state, actionArgs) => {\n        const incorrectAddressMessage = get(\n            actionArgs,\n            'payload.incorrectAddressMessage',\n            ''\n        );\n\n        return {\n            ...state,\n            submitting: false,\n            isAddressIncorrect: incorrectAddressMessage ? true : false,\n            incorrectAddressMessage\n        };\n    },\n    [actions.paymentMethod.submit]: state => {\n        return {\n            ...state,\n            submitting: true\n        };\n    },\n    [actions.paymentMethod.accept]: (state, { payload }) => {\n        return {\n            ...state,\n            editing: null,\n            paymentCode: payload.code,\n            paymentData: payload.data,\n            step: 'form',\n            submitting: false\n        };\n    },\n    [actions.paymentMethod.reject]: state => {\n        return {\n            ...state,\n            submitting: false\n        };\n    },\n    [actions.shippingMethod.submit]: state => {\n        return {\n            ...state,\n            submitting: true\n        };\n    },\n    [actions.shippingMethod.accept]: (state, { payload }) => {\n        return {\n            ...state,\n            editing: null,\n            shippingMethod: payload.carrier_code,\n            shippingTitle: payload.carrier_title,\n            step: 'form',\n            submitting: false,\n            isAddressIncorrect: false,\n            incorrectAddressMessage: ''\n        };\n    },\n    [actions.shippingMethod.reject]: state => {\n        return {\n            ...state,\n            submitting: false\n        };\n    },\n    [actions.order.submit]: state => {\n        return {\n            ...state,\n            submitting: true\n        };\n    },\n    [actions.order.accept]: state => {\n        return {\n            ...state,\n            editing: null,\n            step: 'receipt',\n            submitting: false\n        };\n    },\n    [actions.order.reject]: state => {\n        return {\n            ...state,\n            submitting: false\n        };\n    },\n    [actions.reset]: () => initialState\n};\n\nexport default handleActions(reducerMap, initialState);\n"],"file":"checkout.js"}