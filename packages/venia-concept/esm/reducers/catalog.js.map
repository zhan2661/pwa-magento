{"version":3,"sources":["../../src/reducers/catalog.js"],"names":["handleActions","actions","name","initialState","categories","rootCategoryId","currentPage","pageSize","prevPageTotal","reducerMap","getAllCategories","receive","state","payload","error","getNormalizedCategories","id","setCurrentPage","setPrevPageTotal","extractChildCategories","category","childrenData","child","map","rootCategory"],"mappings":";;;;AAAA,SAASA,aAAT,QAA8B,eAA9B;AAEA,OAAOC,OAAP;AAEA,OAAO,MAAMC,IAAI,GAAG,SAAb;AAEP,OAAO,MAAMC,YAAY,GAAG;AACxBC,EAAAA,UAAU,EAAE,IADY;AAExBC,EAAAA,cAAc,EAAE,IAFQ;AAGxBC,EAAAA,WAAW,EAAE,CAHW;AAIxBC,EAAAA,QAAQ,EAAE,CAJc;AAKxBC,EAAAA,aAAa,EAAE;AALS,CAArB;AAQP,MAAMC,UAAU,GAAG;AACf,GAACR,OAAO,CAACS,gBAAR,CAAyBC,OAA1B,GAAoC,CAACC,KAAD,EAAQ;AAAEC,IAAAA,OAAF;AAAWC,IAAAA;AAAX,GAAR,KAA+B;AAC/D,QAAIA,KAAJ,EAAW;AACP,aAAOF,KAAP;AACH;;AAED,6BACOA,KADP;AAEIR,MAAAA,UAAU,EAAEW,uBAAuB,CAACF,OAAD,CAFvC;AAGIR,MAAAA,cAAc,EAAEQ,OAAO,CAACG;AAH5B;AAKH,GAXc;AAYf,GAACf,OAAO,CAACgB,cAAR,CAAuBN,OAAxB,GAAkC,CAACC,KAAD,EAAQ;AAAEC,IAAAA,OAAF;AAAWC,IAAAA;AAAX,GAAR,KAA+B;AAC7D,QAAIA,KAAJ,EAAW;AACP,aAAOF,KAAP;AACH;;AAED,6BACOA,KADP;AAEIN,MAAAA,WAAW,EAAEO;AAFjB;AAIH,GArBc;AAsBf,GAACZ,OAAO,CAACiB,gBAAR,CAAyBP,OAA1B,GAAoC,CAACC,KAAD,EAAQ;AAAEC,IAAAA,OAAF;AAAWC,IAAAA;AAAX,GAAR,KAA+B;AAC/D,QAAIA,KAAJ,EAAW;AACP,aAAOF,KAAP;AACH;;AAED,6BACOA,KADP;AAEIJ,MAAAA,aAAa,EAAEK;AAFnB;AAIH;AA/Bc,CAAnB;AAkCA,eAAeb,aAAa,CAACS,UAAD,EAAaN,YAAb,CAA5B;AAEA;;AAEA,UAAUgB,sBAAV,CAAiCC,QAAjC,EAA2C;AACvC,QAAM;AAAEC,IAAAA;AAAF,MAAmBD,QAAzB;;AAEA,OAAK,MAAME,KAAX,IAAoBD,YAApB,EAAkC;AAC9B,WAAOF,sBAAsB,CAACG,KAAD,CAA7B;AACH;;AAEDF,EAAAA,QAAQ,CAACC,YAAT,GAAwBA,YAAY,CAACE,GAAb,CAAiB,CAAC;AAAEP,IAAAA;AAAF,GAAD,KAAYA,EAA7B,CAAxB;AAEA,QAAMI,QAAN;AACH;;AAED,SAASL,uBAAT,CAAiCS,YAAjC,EAA+C;AAC3C,QAAMD,GAAG,GAAG,EAAZ;;AAEA,OAAK,MAAMH,QAAX,IAAuBD,sBAAsB,CAACK,YAAD,CAA7C,EAA6D;AACzDD,IAAAA,GAAG,CAACH,QAAQ,CAACJ,EAAV,CAAH,GAAmBI,QAAnB;AACH;;AAED,SAAOG,GAAP;AACH","sourcesContent":["import { handleActions } from 'redux-actions';\n\nimport actions from 'src/actions/catalog';\n\nexport const name = 'catalog';\n\nexport const initialState = {\n    categories: null,\n    rootCategoryId: null,\n    currentPage: 1,\n    pageSize: 6,\n    prevPageTotal: null\n};\n\nconst reducerMap = {\n    [actions.getAllCategories.receive]: (state, { payload, error }) => {\n        if (error) {\n            return state;\n        }\n\n        return {\n            ...state,\n            categories: getNormalizedCategories(payload),\n            rootCategoryId: payload.id\n        };\n    },\n    [actions.setCurrentPage.receive]: (state, { payload, error }) => {\n        if (error) {\n            return state;\n        }\n\n        return {\n            ...state,\n            currentPage: payload\n        };\n    },\n    [actions.setPrevPageTotal.receive]: (state, { payload, error }) => {\n        if (error) {\n            return state;\n        }\n\n        return {\n            ...state,\n            prevPageTotal: payload\n        };\n    }\n};\n\nexport default handleActions(reducerMap, initialState);\n\n/* helpers */\n\nfunction* extractChildCategories(category) {\n    const { childrenData } = category;\n\n    for (const child of childrenData) {\n        yield* extractChildCategories(child);\n    }\n\n    category.childrenData = childrenData.map(({ id }) => id);\n\n    yield category;\n}\n\nfunction getNormalizedCategories(rootCategory) {\n    const map = {};\n\n    for (const category of extractChildCategories(rootCategory)) {\n        map[category.id] = category;\n    }\n\n    return map;\n}\n"],"file":"catalog.js"}